# üì¶ –ü—Ä–æ–µ–∫—Ç REST API –Ω–∞ Go —Å –ß–∏—Å—Ç–æ–π –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π, PostgreSQL –∏ Docker

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π REST API –¥–ª—è —É—Å–ª–æ–≤–Ω–æ–≥–æ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ —è–∑—ã–∫–µ Go —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ **–ß–∏—Å—Ç–æ–π –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã**.  
–í –∫–∞—á–µ—Å—Ç–≤–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **PostgreSQL**, –∞ –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏ ‚Äî **Docker**.

---

## üöÄ –û–±–∑–æ—Ä –ü—Ä–æ–µ–∫—Ç–∞

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**  
  –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —É—á–µ—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π –∏ –≤—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É —Å –ø–æ–ª—É—á–µ–Ω–∏–µ–º —Ç–æ–∫–µ–Ω–∞.

- **–†–∞–∑–º–µ—â–µ–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–π**  
  –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏—è.

- **–õ–µ–Ω—Ç–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π**  
  –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π.

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º **–ß–∏—Å—Ç–æ–π –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã** ‚Äî —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏, —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π.

–û—Å–Ω–æ–≤–Ω—ã–µ —Å–ª–æ–∏:

- **Domain (–°—É—â–Ω–æ—Å—Ç–∏)** ‚Äî –±–∏–∑–Ω–µ—Å-–æ–±—ä–µ–∫—Ç—ã `User`, `Ad` –∏ –∏—Ö –ø—Ä–∞–≤–∏–ª–∞.
- **Use Cases (–°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)** ‚Äî –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞: `AuthUseCase`, `AdUseCase`.
- **Adapters (–ê–¥–∞–ø—Ç–µ—Ä—ã)** ‚Äî HTTP-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã –∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.
- **Infrastructure (–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞)** ‚Äî —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤, HTTP-—Å–µ—Ä–≤–µ—Ä, —É—Ç–∏–ª–∏—Ç—ã.

---

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ü—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ cmd/api/main.go            # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ domain/                # –°—É—â–Ω–æ—Å—Ç–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.go
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ad.go
‚îÇ   ‚îú‚îÄ‚îÄ usecase/               # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.go
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ad.go
‚îÇ   ‚îú‚îÄ‚îÄ adapter/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ handler/           # HTTP-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth_handler.go
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ad_handler.go
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ middleware.go
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ repository/        # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ user_repository.go
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ ad_repository.go
‚îÇ   ‚îî‚îÄ‚îÄ infrastructure/
‚îÇ       ‚îú‚îÄ‚îÄ postgres/          # –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ PostgreSQL
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ user_pg_repository.go
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ ad_pg_repository.go
‚îÇ       ‚îú‚îÄ‚îÄ util/              # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ password.go
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ token.go
‚îú‚îÄ‚îÄ migrations/                # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ 001_create_users_table.sql
‚îÇ   ‚îî‚îÄ‚îÄ 002_create_ads_table.sql
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ go.mod
‚îî‚îÄ‚îÄ go.sum
```

---

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –ó–∞–ø—É—Å–∫

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**

```bash
git clone <URL_–í–ê–®–ï–ì–û_–†–ï–ü–û–ó–ò–¢–û–†–ò–Ø>
cd <–ò–ú–Ø_–ü–ê–ü–ö–ò_–ü–†–û–ï–ö–¢–ê>
```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–¥—É–ª—å Go:**

```bash
go mod tidy
```

3. **–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª:**

```env
DATABASE_URL="postgresql://user:password@db:5432/marketplace_db?sslmode=disable"
PORT="8080"
JWT_SECRET_KEY="–≤–∞—à_–æ—á–µ–Ω—å_—Å–µ–∫—Ä–µ—Ç–Ω—ã–π_–∫–ª—é—á_–¥–ª—è_—Ç–æ–∫–µ–Ω–æ–≤_–º–∏–Ω–∏–º—É–º_32_—Å–∏–º–≤–æ–ª–∞"

POSTGRES_DB="marketplace_db"
POSTGRES_USER="user"
POSTGRES_PASSWORD="password"
```

4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç —á–µ—Ä–µ–∑ Docker Compose:**

```bash
docker-compose down --volumes  # –û—á–∏—Å—Ç–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Ç–æ–º–æ–≤
docker-compose up --build      # –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
```

- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: http://localhost:8080  
- PostgreSQL: `localhost:5433` (–≤–Ω—É—Ç—Ä–∏ Docker ‚Äî `5432`)

---

## ‚öôÔ∏è API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã ‚Äî –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:8080`

---

### 1. üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**URL:** `/auth/register`  
**–ú–µ—Ç–æ–¥:** `POST`  
**Content-Type:** `application/json`

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**

```json
{
  "login": "myuser",
  "password": "MyStrongPassword123!"
}
```

**–ü—Ä–∏–º–µ—Ä cURL:**

```bash
curl -X POST http://localhost:8080/auth/register -H "Content-Type: application/json" -d '{"login": "myuser", "password": "MyStrongPassword123!"}'
```

---

### 2. üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

**URL:** `/auth/login`  
**–ú–µ—Ç–æ–¥:** `POST`  
**Content-Type:** `application/json`

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**

```json
{
  "login": "myuser",
  "password": "MyStrongPassword123!"
}
```

**–ü—Ä–∏–º–µ—Ä cURL:**

```bash
curl -X POST http://localhost:8080/auth/login -H "Content-Type: application/json" -d '{"login": "myuser", "password": "MyStrongPassword123!"}'
```

---

### 3. üì¢ –°–æ–∑–¥–∞–Ω–∏–µ –û–±—ä—è–≤–ª–µ–Ω–∏—è (–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞)

**URL:** `/ads`  
**–ú–µ—Ç–æ–¥:** `POST`  
**–ó–∞–≥–æ–ª–æ–≤–æ–∫:** `Authorization: Bearer <–í–ê–®_–¢–û–ö–ï–ù>`  
**Content-Type:** `application/json`

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**

```json
{
  "title": "–ü—Ä–æ–¥–∞–º —Å—Ç–∞—Ä—ã–π –≤–µ–ª–æ—Å–∏–ø–µ–¥",
  "description": "–û—Ç–ª–∏—á–Ω—ã–π –≤–µ–ª–æ—Å–∏–ø–µ–¥, –ø–æ—á—Ç–∏ –Ω–æ–≤—ã–π...",
  "image_url": "https://placehold.co/600x400/000000/FFFFFF?text=Bicycle",
  "price": 150.00
}
```

**–ü—Ä–∏–º–µ—Ä cURL:**

```bash
curl -X POST http://localhost:8080/ads -H "Content-Type: application/json" -H "Authorization: Bearer <–í–ê–®_–¢–û–ö–ï–ù>" -d '{
  "title": "–ü—Ä–æ–¥–∞–º —Å—Ç–∞—Ä—ã–π –≤–µ–ª–æ—Å–∏–ø–µ–¥",
  "description": "–û—Ç–ª–∏—á–Ω—ã–π –≤–µ–ª–æ—Å–∏–ø–µ–¥...",
  "image_url": "https://placehold.co/600x400",
  "price": 150.00
}'
```

---

### 4. üìÑ –ü–æ–ª—É—á–µ–Ω–∏–µ –õ–µ–Ω—Ç—ã –û–±—ä—è–≤–ª–µ–Ω–∏–π

**URL:** `/ads`  
**–ú–µ—Ç–æ–¥:** `GET`

**–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä     | –û–ø–∏—Å–∞–Ω–∏–µ                        |
|--------------|----------------------------------|
| `page`       | –ù–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1) |
| `limit`      | –ö–æ–ª-–≤–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10) |
| `sort_by`    | –ü–æ–ª–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ (`created_at`, `price`) |
| `sort_order` | –ü–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ (`asc`, `desc`)     |
| `min_price`  | –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞               |
| `max_price`  | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞              |

**–ü—Ä–∏–º–µ—Ä cURL (–±–∞–∑–æ–≤—ã–π):**

```bash
curl -X GET http://localhost:8080/ads
```

**–ü—Ä–∏–º–µ—Ä cURL (—Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏):**

```bash
curl -X GET "http://localhost:8080/ads?page=1&limit=5&sort_by=price&sort_order=desc&min_price=100&max_price=500"
```

---

> üîê –î–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π –Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–µ–π—Å—Ç–≤—É—é—â–∏–π JWT-—Ç–æ–∫–µ–Ω, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –ø—Ä–∏ –ª–æ–≥–∏–Ω–µ.

---

–ì–æ—Ç–æ–≤–æ! üéâ